print(var_caca)
}
variable = data[0,]
for(var_caca in variable){
print(var_caca)
}
variable = data[0,0]
for(var_caca in variable){
print(var_caca)
}
var_caca
data[0,0]
data[0,1]
for(var_caca in colnames(data)){
print(var_caca)
}
variable = colnames(data)
variable = colnames(data)
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable
variable = colnames(data)
variable
som_model2$codes
variable = colnames(som_model2$codes)
variable
variable = colnames(som_model2$codes)
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal","DefectosTotales","ASNM")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("year","DefectosTotales", "ASNM","Luminosidad","prec1","prec2","prec3","prec4", "prec5","prec6","prec7","prec8","prec9","prec10","tmin1","tmin2","tmin3",
"tmin4","tmin5","tmin6","tmin7","tmin8","tmin9","tmin10","tmax1","tmax2", "tmax3","tmax4","tmax5","tmax6","tmax7","tmax8","tmax9","tmax10","tmean1"
,"tmean2","tmean3","tmean4","tmean5","tmean6","tmean7","tmean8","tmean9","tmean10", "dtr1","dtr2","dtr3","dtr4","dtr5","dtr6","dtr7","dtr8","dtr9" , "dtr10",
"PrecTotal","TminTotal","TmaxTotal","TmeanTotal","DtrTotal","PrecTotalAvg","TminTotalAvg","TmaxTotalAvg" ,"TmeanTotalAvg","DtrTotalAvg","OrientationNum",
"Slope","pH_avg","org_avg","Franco","Arcilloso","Limoso"  ,"Arenoso","Cascajoso","Aroma.Fragancia", "Acidez","Cuerpo","Sabor","SaborResidual" ,  "Dulzor",
"Uniformidad" ,"Balance","TazaLimpia","PuntajeCatador" , "PuntajeTotal" ,   "Category" )
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("year","DefectosTotales", "ASNM","Luminosidad","prec1","prec2","prec3","prec4", "prec5","prec6","prec7","prec8","prec9","prec10","tmean1"
,"tmean2","tmean3","tmean4","tmean5","tmean6","tmean7","tmean8","tmean9","tmean10", "dtr1","dtr2","dtr3","dtr4","dtr5","dtr6","dtr7","dtr8","dtr9" , "dtr10",
"PrecTotal","TminTotal","TmaxTotal","TmeanTotal","DtrTotal","PrecTotalAvg","TminTotalAvg","TmaxTotalAvg" ,"TmeanTotalAvg","DtrTotalAvg","OrientationNum",
"Slope","pH_avg","org_avg","Franco","Arcilloso","Limoso"  ,"Arenoso","Cascajoso","Aroma.Fragancia", "Acidez","Cuerpo","Sabor","SaborResidual" ,  "Dulzor",
"Uniformidad" ,"Balance","TazaLimpia","PuntajeCatador" , "PuntajeTotal" ,   "Category" )
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("year","DefectosTotales", "ASNM","Luminosidad","prec1","prec2","prec3","prec4", "prec5","prec6","prec7","prec8","prec9","prec10","tmean1"
,"tmean2","tmean3","tmean4","tmean5","tmean6","tmean7","tmean8","tmean9","tmean10","PrecTotalAvg","TminTotalAvg","TmaxTotalAvg" ,"TmeanTotalAvg","DtrTotalAvg","OrientationNum",
"Slope","pH_avg","org_avg","Franco","Arcilloso","Limoso"  ,"Arenoso","Cascajoso","Aroma.Fragancia", "Acidez","Cuerpo","Sabor","SaborResidual" ,  "Dulzor",
"Uniformidad" ,"Balance","TazaLimpia","PuntajeCatador" , "PuntajeTotal" ,   "Category" )
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal","DefectosTotales","ASNM", "Luminosidad")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez","DefectosTotales","ASNM", "Luminosidad")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM", "Luminosidad")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("prec1","prec2","prec3","prec4", "prec5","prec6","prec7","prec8","prec9","prec10","tmin1","tmin2","tmin3",
"tmin4","tmin5","tmin6","tmin7","tmin8","tmin9","tmin10","tmax1","tmax2", "tmax3","tmax4","tmax5","tmax6","tmax7","tmax8","tmax9","tmax10","tmean1"
,"tmean2","tmean3","tmean4","tmean5","tmean6","tmean7","tmean8","tmean9","tmean10", "dtr1","dtr2","dtr3","dtr4","dtr5","dtr6","dtr7","dtr8","dtr9" , "dtr10",
"PrecTotal","TminTotal","TmaxTotal","TmeanTotal","DtrTotal","PrecTotalAvg","TminTotalAvg","TmaxTotalAvg" ,"TmeanTotalAvg","DtrTotalAvg","OrientationNum",
"Slope","pH_avg","org_avg","Franco","Arcilloso","Limoso"  ,"Arenoso","Cascajoso","Aroma.Fragancia", "Acidez","Cuerpo","Sabor","SaborResidual" ,  "Dulzor",
"Uniformidad" ,"Balance","TazaLimpia","PuntajeCatador" , "PuntajeTotal")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM", "Luminosidad", "Franco", "Acrilloso","Limoso", "Arenoso")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM", "Luminosidad", "Franco", "Acrilloso","Limoso", "Arenoso")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM", "Luminosidad", "Franco", "Acrilloso","Limoso", "Arenoso")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2011_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
#plot(fit)
dev.off()
}
data_som <- data_matrix_2016
som_grid <- somgrid(xdim = 15, ydim=15, topo='hexagonal')
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
keep.data = TRUE)
k= 5
som_cluster <- cutree(hclust(dist(som_model2$codes)), k)
som_grid <- somgrid(xdim = 20, ydim=15, topo='hexagonal')
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
keep.data = TRUE)
k= 5
som_cluster <- cutree(hclust(dist(som_model2$codes)), k)
png(paste("2016_cluster.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="mapping", bgcol = pretty_palette[som_cluster], main = "Clusters")
add.cluster.boundaries(som_model2, som_cluster)
dev.off()
png(paste("2016_distance.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="dist.neighbours")
dev.off()
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2016_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
som_grid <- somgrid(xdim = 20, ydim=20, topo='hexagonal')
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
toroidal = TRUE,
keep.data = TRUE)
som_grid <- somgrid(xdim = 15, ydim=15, topo='hexagonal')
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
toroidal = TRUE,
keep.data = TRUE)
k= 5
som_cluster <- cutree(hclust(dist(som_model2$codes)), k)
png(paste("2016_cluster.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="mapping", bgcol = pretty_palette[som_cluster], main = "Clusters")
add.cluster.boundaries(som_model2, som_cluster)
dev.off()
png(paste("2016_distance.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="dist.neighbours")
dev.off()
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","pH_avg","org_avg","ASNM","PuntajeTotal","DefectosTotales")
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("2016_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
setwd(path)
filename <- "DataRisaralda_v2Numeric_Complete_utf-8.csv"
data = read.csv(filename, header=T, sep=",")
data <- data[complete.cases(data),]
setwd(pathSOM)
data_matrix <- as.matrix(scale(data))
som_grid <- somgrid(xdim = 25, ydim=25, topo='hexagonal')
data_som <- data_matrix
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
keep.data = TRUE)
k= 5
som_cluster <- cutree(hclust(dist(som_model2$codes)), k)
png(paste("AllData_Clusters.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="mapping", bgcol = pretty_palette[som_cluster], main = "Clusters")
add.cluster.boundaries(som_model2, som_cluster)
dev.off()
png(paste("AllData_Distances.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="dist.neighbours")
dev.off()
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","pH_avg","org_avg","ASNM","Slope","Orientation","PuntajeTotal","DefectosTotales")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("All_Compact_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("All_Compact_var_",var_str,".png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
setwd(path)
filename <- "DataRisaralda_v2Numeric_Complete_utf-8.csv"
data = read.csv(filename, header=T, sep=",")
data <- data[complete.cases(data),]
setwd(pathSOM)
data_matrix <- as.matrix(scale(data))
som_grid <- somgrid(xdim = 25, ydim=25, topo='hexagonal')
data_som <- data_matrix
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
keep.data = TRUE)
k= 5
som_cluster <- cutree(hclust(dist(som_model2$codes)), k)
png(paste("AllData_Clusters.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="mapping", bgcol = pretty_palette[som_cluster], main = "Clusters")
add.cluster.boundaries(som_model2, som_cluster)
dev.off()
png(paste("AllData_Distances.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="dist.neighbours")
dev.off()
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","pH_avg","org_avg","ASNM","Slope","Orientation","PuntajeTotal","DefectosTotales")
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("All_Compact_var_",var_str,".png",sep=""), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("All_Compact_var_",var_str,".png",sep=""), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
png(paste("AllDataClusters.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="mapping", bgcol = pretty_palette[som_cluster], main = "Clusters")
add.cluster.boundaries(som_model2, som_cluster)
dev.off()
png(paste("AllDataDistances.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="dist.neighbours")
dev.off()
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","pH_avg","org_avg","ASNM","Slope","Orientation","PuntajeTotal","DefectosTotales")
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("AllCompactvar",var_str,".png",sep=""), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal","Slope","Orientation", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("AllCompactvar",var_str,".png",sep=""), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
setwd(path)
filename <- "DataRisaralda_v2Numeric_Complete_utf-8.csv"
data = read.csv(filename, header=T, sep=",")
data <- data[complete.cases(data),]
setwd(pathSOM)
data_matrix <- as.matrix(scale(data))
som_grid <- somgrid(xdim = 25, ydim=25, topo='hexagonal')
data_som <- data_matrix
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
keep.data = FALSE)
k= 5
som_cluster <- cutree(hclust(dist(som_model2$codes)), k)
png(paste("AllDataClusters.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="mapping", bgcol = pretty_palette[som_cluster], main = "Clusters")
add.cluster.boundaries(som_model2, som_cluster)
dev.off()
png(paste("AllDataDistances.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="dist.neighbours")
dev.off()
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","pH_avg","org_avg","ASNM","Slope","Orientation","PuntajeTotal","DefectosTotales")
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal","Slope","Orientation", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("AllCompactvar",var_str,".png",sep=""), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
som_model2 <- som(data_som,
grid=som_grid,
rlen=100,
alpha=c(0.05,0.01),
keep.data = TRUE)
k= 5
som_cluster <- cutree(hclust(dist(som_model2$codes)), k)
png(paste("AllDataClusters.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="mapping", bgcol = pretty_palette[som_cluster], main = "Clusters")
add.cluster.boundaries(som_model2, som_cluster)
dev.off()
png(paste("AllDataDistances.png"), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type="dist.neighbours")
dev.off()
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","pH_avg","org_avg","ASNM","Slope","Orientation","PuntajeTotal","DefectosTotales")
variable = c("PrecTotalAvg","TminTotalAvg","TmaxTotalAvg","TmeanTotalAvg","DtrTotalAvg","PuntajeTotal","Slope","Orientation", "Acidez", "Dulzor","DefectosTotales","ASNM","pH_avg", "org_avg","Arenoso", "Franco")
for(var_str in variable) {
# get the index from the name
var <- grep(var_str, colnames(data_som))
var_unscaled <- aggregate(as.numeric(data_som[,var]), by=list(som_model2$unit.classif), FUN=mean, simplify=TRUE)[,2]
# Saving the plots
png(paste("AllCompactvar",var_str,".png",sep=""), width=4, height=4, units="in", res=300)
par(mar=c(4,4,1,1))
plot(som_model2, type = "property", property=var_unscaled, main=names(data)[var], palette.name=coolBlueHotRed)
dev.off()
}
load("C:/Users/thsch/Desktop/Bachelor_Thesis_2017_Sources/Notebook/R/Projects/BachelorThesis/All-Functions-AEPS_BD.RData")
data_matrix <- as.matrix(scale(data))
data_matrix_2011 <- as.matrix(scale(subset(data, year==2011), scale=FALSE))
data_matrix_2016 <- as.matrix(scale(subset(data, year==2016), scale=FALSE))
pretty_palette <- c("#1f77b4", '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#99000b', '#99FF00', '#FFFF44', '#00caca','#beef00','#00beef', '#cacabe')
coolBlueHotRed <- function(n, alpha = 1) { rainbow(n, end=4/6, alpha=alpha)[n:1] }
