install.packages(c("caret", "snowfall"))
library("caret", lib.loc="~/R/win-library/3.0")
library("gtools", lib.loc="~/R/win-library/3.0")
install.packages("caret")
library("caret", lib.loc="~/R/win-library/3.0")
rm(list=ls())
library(randomForest)
library(caret)
dirFol <- "C:/Users/thsch/Desktop/Bachelor_Thesis_2017_Sources/Notebook/R/Projects/BachelorThesis/"
setwd(dirFol)
datNam <- "DataRisaralda_v2Numeric_CompleteV2_utf-8.csv"
dataset   <- read.csv(datNam,row.names=1)
dataset   <- dataset[dataset$Acidez != 0,]
dataset$Acidez = as.factor(dataset$Acidez)
set.seed(123)
inTrain  <- createDataPartition(y=dataset[,72], p=0.7, list=F)
training <- dataset[inTrain,]
testing  <- dataset[-inTrain,]
dataNames = names(dataset)
x <- training[,1:71]
y <- training[,72]
control <- trainControl(method="repeatedcv", number=10, repeats=3)
seed <- 7
set.seed(seed)
mtry <- sqrt(ncol(x))
rf_default <- train(y=y,x=x,  method="rf", trControl=control)
rf_default <- train(y=y,x=x, mtry=10, method="rf", trControl=control)
train(y=y,x=x, mtry=10, method="rf"
)
training
training <- dataset[inTrain,]
testing  <- dataset[-inTrain,]
dataNames = names(dataset)
x
y
train(y=y,x=x, mtry=10, method="rf", trControl=control)
warnings()
training
names(training)
rf_default <- train(Acidez~.,data=training, mtry=10, method="rf", trControl=control)
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=10, method="rf", trControl=control)
tunegrid <- expand.grid(.mtry=mtry)
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=10, method="rf", trControl=control)
set.seed(seed)
mtry <- sqrt(ncol(x))
tunegrid <- expand.grid(.mtry=mtry)
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
class2ind <- function(cl)
{
n <- length(cl)
cl <- as.factor(cl)
x <- matrix(0, n, length(levels(cl)) )
x[(1:n) + n*(unclass(cl)-1)] <- 1
dimnames(x) <- list(names(cl), levels(cl))
x
}
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
set.seed(123)
mtry <- sqrt(ncol(x))
tunegrid <- expand.grid(.mtry=mtry)
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
training
rm(list=ls())
library(randomForest)
library(caret)
dirFol <- "C:/Users/thsch/Desktop/Bachelor_Thesis_2017_Sources/Notebook/R/Projects/BachelorThesis/"
setwd(dirFol)
datNam <- "DataRisaralda_v2Numeric_CompleteV2_utf-8.csv"
dataset   <- read.csv(datNam,row.names=1)
dataset   <- dataset[dataset$Acidez != 0,]
dataset$Acidez = as.factor(dataset$Acidez)
set.seed(123)
inTrain  <- createDataPartition(y=dataset[,72], p=0.7, list=F)
training <- dataset[inTrain,]
testing  <- dataset[-inTrain,]
dataNames = names(dataset)
x <- training[,1:71]
y <- training[,72]
control <- trainControl(method="repeatedcv", number=10, repeats=3)
set.seed(123)
mtry <- sqrt(ncol(x))
tunegrid <- expand.grid(.mtry=mtry)
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
y <- as.factor(training[,72])
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
training[,72]
warning()
warnings()
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
warnings()
rf_default <- train(Acidez~.,data=training,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
rf_default <- train(Acidez~.,data=dataset,tunegrid=tunegrid, mtry=mtry, method="rf", trControl=control)
